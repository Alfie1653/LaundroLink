<!DOCTYPE html>
<html>
<head>
  <title>LaundroLink</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>

  <!-- HERO SECTION -->
  <div class="hero">
    <h1>LaundroLink</h1>
    <p>Find your favorite laundry services in seconds!</p>
    <div class="hero-buttons">
      <a href="/register">
        <button class="btn-register">Register Laundry Service</button>
      </a>
      <a href="/login">
        <button class="btn-register btn-login">Owner Login</button>
      </a>
    </div>
  </div>

  <!-- SORTING OPTIONS -->
  <div class="sort-container">
    <label for="sort">Sort by:</label>
    <select id="sort" name="sort" onchange="applySort(this)">
      <option value="date" {% if sort_by == 'date' %}selected{% endif %}>Date Added</option>
      <option value="rating" {% if sort_by == 'rating' %}selected{% endif %}>Rating</option>
      <option value="alphabetical" {% if sort_by == 'alphabetical' %}selected{% endif %}>A-Z</option>
    </select>
  </div>

  <script>
  function applySort(select) {
    const sort = select.value;
    window.location.href = `/?sort=${sort}`;
  }
  </script>

  <!-- CARDS CONTAINER -->
  <div class="cards-container">
    {% for p in providers %}
    <a href="/service/{{ p.id }}" class="card-link">
      <div class="card">
        <!-- Profile Image -->
        <div class="card-image-wrapper">
          <img src="{{ url_for('static', filename='uploads/' + p.profile_pic) }}" alt="{{ p.name }}">
          
        </div>

        <!-- Card Info -->
        <div class="card-info">
          <h3>{{ p.name }}</h3>
          <p class="price">KES {{ p.price_per_kg }} / kg</p>

          {% if p.num_reviews > 0 %}
            <p class="rating">
              <span class="stars">
                {% for i in range(1, 6) %}
                  {% if p.avg_rating >= i %}
                    ★
                  {% elif p.avg_rating >= i - 0.5 %}
                    ☆
                  {% else %}
                    ☆
                  {% endif %}
                {% endfor %}
              </span>
              <span class="num-reviews">
                ({{ p.num_reviews }} review{{ 's' if p.num_reviews > 1 else '' }})
              </span>
            </p>
          {% else %}
            <p class="rating no-rating" style="color: #00796b;">No ratings yet</p>
          {% endif %}
        </div>

        <!-- Hidden Request Button (appears on hover) -->
        <div class="card-action">
          <a
            href="{{ url_for('request_service', provider_id=p.id) }}"
            target="_blank"
            class="btn"
          >
            Request Service
          </a>
        </div>
      </div>
    </a>
    {% endfor %}
  </div>

</body>
</html>
